/*! For license information please see 162.bfea46d8.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkpickleball_courts=self.webpackChunkpickleball_courts||[]).push([[162],{162:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var a=s(9379),l=s(9950),n=s(6479),r=s(6230);const o=(0,r.A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var d=s(2607);const i=(0,r.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),c=(0,r.A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),m=(0,r.A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var x=s(2004),u=s(9800),h=s(4414);const p=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,u.QP)((0,x.$)(t))};function b(e){var t,s,r;let{isOpen:o,onClose:d,booking:i,slots:c=[],onUpdateRenter:m,onUpdatePayment:x,onAddSlot:u,onRemoveSlot:b,onToggleSlotPayment:g,onMarkAllPaid:N,onMarkFree:y,onDeleteSession:w,isCreating:k,onConfirmCreation:S}=e;const[C,P]=(0,l.useState)("overview"),[A,D]=(0,l.useState)(!1),[T,M]=(0,l.useState)(null),[E,O]=(0,l.useState)(!1),[I,R]=(0,l.useState)({}),H=(null===i||void 0===i||null===(t=i.paymentSummary)||void 0===t?void 0:t.totalAmount)||0,F=(null===i||void 0===i||null===(s=i.paymentSummary)||void 0===s?void 0:s.amountPaid)||0,L=H-F,B=(null===i||void 0===i||null===(r=i.paymentSummary)||void 0===r?void 0:r.paymentStatus)||"UNPAID";if(!o||!i)return null;const _=e=>{if(1===c.length)return M(e),void O(!0);e.isPaid?(M(e),D(!0)):b(e.slotId,"NONE")},U=e=>{T&&b(T.slotId,e?"REFUND":"FORFEIT"),D(!1),M(null)};return(0,h.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:[(0,h.jsxs)("div",{className:"w-full max-w-2xl bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[(0,h.jsxs)("div",{className:"flex items-center justify-between border-b border-slate-200 px-6 py-4 bg-slate-50",children:[(0,h.jsxs)("div",{children:[(0,h.jsx)("h2",{className:"text-lg font-bold text-slate-900",children:k?"New Booking":"OPEN_PLAY_BLOCK"===i.type?"Open Play Block":"Booking Management"}),(0,h.jsx)("p",{className:"text-xs text-slate-500 font-mono",children:i.id})]}),(0,h.jsx)("button",{onClick:d,className:"rounded-full p-2 text-slate-400 hover:bg-slate-200 hover:text-slate-600 transition-colors",children:(0,h.jsx)(n.A,{className:"h-5 w-5"})})]}),"OPEN_PLAY_BLOCK"!==i.type&&(0,h.jsx)("div",{className:"flex border-b border-slate-200 px-6",children:["overview","slots","history"].map(e=>(0,h.jsx)("button",{onClick:()=>P(e),className:p("px-4 py-3 text-sm font-medium border-b-2 transition-colors",C===e?"border-slate-900 text-slate-900":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),(0,h.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:["overview"===C&&(0,h.jsx)(v,{booking:i,slots:c,onUpdateRenter:(e,t)=>{I.name&&t.name&&R(e=>(0,a.A)((0,a.A)({},e),{},{name:null})),I.contact&&t.contact&&R(e=>(0,a.A)((0,a.A)({},e),{},{contact:null})),m(e,t)},total:H,paid:F,balance:L,status:B,onUpdatePayment:x,onDeleteSession:b?()=>{c.length>0&&_(c[0])}:void 0,errors:I}),"slots"===C&&(0,h.jsx)(j,{slots:c,onRemove:_,onAdd:u,booking:i,onToggleSlotPayment:g,onMarkAllPaid:N,onMarkFree:y}),"history"===C&&(0,h.jsx)(f,{logs:i.auditLogs||[]})]}),k&&(0,h.jsxs)("div",{className:"p-4 border-t border-slate-200 bg-slate-50 flex justify-end gap-3",children:[(0,h.jsx)("button",{onClick:d,className:"px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-200 rounded-lg",children:"Cancel"}),(0,h.jsx)("button",{onClick:()=>{(()=>{const e={};if("OPEN_PLAY_BLOCK"!==i.type){var t,s;const a=i.renter||{};null!==(t=a.name)&&void 0!==t&&t.trim()||(e.name="Name is required"),null!==(s=a.contact)&&void 0!==s&&s.trim()||(e.contact="Contact is required")}return R(e),0===Object.keys(e).length})()?S&&S():"overview"!==C&&P("overview")},className:"px-4 py-2 text-sm font-bold text-white bg-emerald-600 hover:bg-emerald-700 rounded-lg shadow-sm",children:"Save Booking"})]})]}),A&&(0,h.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/20 backdrop-blur-[1px]",children:(0,h.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-96 transform scale-100 transition-all",children:[(0,h.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Issue Refund?"}),(0,h.jsx)("p",{className:"text-sm text-slate-600 mb-6",children:"This slot is marked as PAID. Do you want to refund the amount to the renter, or forfeit it (keep as penalty)?"}),(0,h.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,h.jsx)("button",{onClick:()=>U(!1),className:"px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-100 rounded-lg",children:"No (Forfeit)"}),(0,h.jsx)("button",{onClick:()=>U(!0),className:"px-4 py-2 text-sm font-medium text-white bg-slate-900 hover:bg-slate-800 rounded-lg",children:"Yes, Refund"})]})]})}),E&&(0,h.jsx)("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/20 backdrop-blur-[1px]",children:(0,h.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-96 border-l-4 border-red-500",children:[(0,h.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Delete Booking?"}),(0,h.jsxs)("p",{className:"text-sm text-slate-600 mb-6",children:["You are removing the last active slot. This will ",(0,h.jsx)("strong",{children:"cancel and remove the entire booking"}),"."]}),(0,h.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,h.jsx)("button",{onClick:()=>O(!1),className:"px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-100 rounded-lg",children:"Cancel"}),(0,h.jsx)("button",{onClick:()=>{T&&(T.isPaid?(O(!1),D(!0)):(b(T.slotId,"NONE"),O(!1),d()))},className:"px-4 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg",children:"Yes, Delete All"})]})]})})]})}const v=e=>{var t,s,a,n,r;let{booking:d,slots:i=[],onUpdateRenter:c,total:m,paid:x,balance:u,status:b,onUpdatePayment:v,onDeleteSession:j,errors:f={}}=e;const[g,N]=(0,l.useState)((null===(t=d.renter)||void 0===t?void 0:t.name)||""),[y,w]=(0,l.useState)((null===(s=d.renter)||void 0===s?void 0:s.contact)||""),[k,S]=(0,l.useState)((null===(a=d.renter)||void 0===a?void 0:a.email)||""),[C,P]=(0,l.useState)((null===(n=d.paymentSummary)||void 0===n?void 0:n.paymentMethod)||"CASH"),[A,D]=(0,l.useState)(x.toString());l.useEffect(()=>{D(x.toString())},[x]),l.useEffect(()=>{var e,t;null!==(e=d.paymentSummary)&&void 0!==e&&e.paymentMethod&&P(null===(t=d.paymentSummary)||void 0===t?void 0:t.paymentMethod)},[null===(r=d.paymentSummary)||void 0===r?void 0:r.paymentMethod]);const T=i.reduce((e,t)=>e+(new Date(t.endTime)-new Date(t.startTime)),0)/36e5,M=new Set(i.map(e=>e.courtId)).size,E="OPEN_PLAY_BLOCK"===d.type;return(0,h.jsxs)("div",{className:"space-y-6",children:[E?(0,h.jsx)("div",{className:"p-4 bg-slate-100 rounded text-center text-sm text-slate-500",children:"Open Play Blocks do not have renter details."}):(0,h.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200 space-y-3",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,h.jsx)(o,{className:"h-4 w-4 text-slate-400"}),(0,h.jsx)("h3",{className:"text-sm font-semibold text-slate-700",children:"Renter Details"})]}),(0,h.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,h.jsxs)("div",{children:[(0,h.jsxs)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:["Name ",(0,h.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,h.jsx)("input",{value:g,onChange:e=>N(e.target.value),className:p("w-full text-sm border-slate-200 rounded-md focus:ring-slate-900 focus:border-slate-900",f.name&&"border-red-500 focus:border-red-500"),placeholder:"John Doe"}),f.name&&(0,h.jsx)("p",{className:"text-[10px] text-red-500 mt-1",children:f.name})]}),(0,h.jsxs)("div",{children:[(0,h.jsxs)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:["Contact ",(0,h.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,h.jsx)("input",{value:y,onChange:e=>w(e.target.value),className:p("w-full text-sm border-slate-200 rounded-md focus:ring-slate-900 focus:border-slate-900",f.contact&&"border-red-500 focus:border-red-500"),placeholder:"0912..."}),f.contact&&(0,h.jsx)("p",{className:"text-[10px] text-red-500 mt-1",children:f.contact})]}),(0,h.jsxs)("div",{className:"col-span-2",children:[(0,h.jsx)("label",{className:"block text-xs font-medium text-slate-500 mb-1",children:"Email"}),(0,h.jsx)("input",{value:k,onChange:e=>S(e.target.value),className:"w-full text-sm border-slate-200 rounded-md focus:ring-slate-900 focus:border-slate-900",placeholder:"john@example.com"})]})]}),(0,h.jsx)("div",{className:"flex justify-end pt-2",children:(0,h.jsx)("button",{onClick:()=>{c(d.id,{name:g,contact:y,email:k})},className:"text-xs font-medium text-blue-600 hover:text-blue-700",children:"Save Changes"})})]}),!E&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[(0,h.jsx)("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Rental Summary"}),(0,h.jsxs)("div",{className:"space-y-2 text-sm text-slate-600",children:[(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("span",{children:"Rental Duration:"}),(0,h.jsxs)("span",{className:"font-medium text-slate-900",children:[T.toFixed(1)," hours"]})]}),(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("span",{children:"Rented # of Courts:"}),(0,h.jsx)("span",{className:"font-medium text-slate-900",children:M})]}),(0,h.jsxs)("div",{className:"flex justify-between border-t border-slate-100 pt-2 mt-2",children:[(0,h.jsx)("span",{children:"Total Due:"}),(0,h.jsxs)("span",{className:"font-bold text-slate-900",children:["PHP ",m.toLocaleString()]})]})]})]}),(0,h.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-slate-200",children:[(0,h.jsx)("h3",{className:"text-sm font-semibold text-slate-700 mb-3",children:"Payment Summary"}),(0,h.jsxs)("div",{className:"space-y-2 text-sm text-slate-600",children:[(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("span",{children:"Unpaid # Hours:"}),(0,h.jsxs)("span",{className:"font-medium text-slate-900",children:[i.filter(e=>!e.isPaid).reduce((e,t)=>{const s=new Date(t.startTime);return e+(new Date(t.endTime)-s)},0)/36e5," hours"]})]}),(0,h.jsxs)("div",{className:"flex justify-between",children:[(0,h.jsx)("span",{children:"Balance:"}),(0,h.jsxs)("span",{className:"font-semibold text-rose-600",children:["PHP ",(m-x).toLocaleString()]})]}),(0,h.jsxs)("div",{className:"flex justify-between border-t border-slate-100 pt-2 mt-2",children:[(0,h.jsx)("span",{children:"Total Paid:"}),(0,h.jsxs)("span",{className:"font-bold text-emerald-600",children:["PHP ",x.toLocaleString()]})]})]})]})]})]})},j=e=>{let{slots:t,onRemove:s,onAdd:n,booking:r,onToggleSlotPayment:o,onMarkAllPaid:x,onMarkFree:u}=e;const[b,v]=(0,l.useState)(!1),[j,f]=(0,l.useState)("1"),[g,N]=(0,l.useState)("10"),[y,w]=(0,l.useState)("CASH"),k=Array.from({length:16},(e,t)=>t+7),S=l.useMemo(()=>{const e={};return t.forEach(t=>{e[t.courtId]||(e[t.courtId]=[]),e[t.courtId].push(t)}),e},[t]),C=Object.keys(S).sort((e,t)=>Number(e)-Number(t)),[P,A]=(0,l.useState)({});return(0,h.jsxs)("div",{className:"space-y-4",children:[(0,h.jsxs)("div",{className:"flex justify-between items-center",children:[(0,h.jsxs)("h3",{className:"text-sm font-semibold text-slate-900",children:["Active Slots (",t.length,")"]}),(0,h.jsxs)("button",{onClick:()=>v(!b),className:"flex items-center gap-1 text-xs font-medium text-slate-600 hover:text-slate-900 bg-slate-100 px-3 py-1.5 rounded-md hover:bg-slate-200",children:[(0,h.jsx)(d.A,{className:"h-3 w-3"}),"Add Slot"]})]}),(0,h.jsxs)("div",{className:"flex items-center gap-2 bg-slate-50 p-3 rounded-lg border border-slate-200",children:[(0,h.jsx)("span",{className:"text-xs font-semibold text-slate-500 uppercase",children:"Bulk Pay:"}),(0,h.jsxs)("select",{value:y,onChange:e=>w(e.target.value),className:"text-sm border-slate-300 rounded focus:border-slate-900 focus:ring-0 py-1.5 px-3 min-w-[120px]",children:[(0,h.jsx)("option",{value:"CASH",children:"Cash"}),(0,h.jsx)("option",{value:"GCASH",children:"GCash"}),(0,h.jsx)("option",{value:"GOTYME",children:"GoTyme"}),(0,h.jsx)("option",{value:"FREE",children:"Free"})]}),(0,h.jsx)("button",{onClick:()=>{"FREE"===y?u(r.id):x(r.id,y)},className:"px-4 py-1.5 bg-slate-900 text-white text-sm font-medium rounded shadow-sm hover:bg-slate-800 disabled:opacity-50",disabled:0===t.length,children:"FREE"===y?"Set All Free":"Mark All Paid"})]}),b&&(0,h.jsxs)("div",{className:"bg-slate-50 p-3 rounded-lg border border-slate-200 flex gap-2 items-end animate-in fade-in slide-in-from-top-2",children:[(0,h.jsxs)("div",{className:"flex-1",children:[(0,h.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Court"}),(0,h.jsx)("select",{value:j,onChange:e=>f(e.target.value),className:"w-full text-sm border-slate-300 rounded focus:border-slate-900 focus:ring-0",children:[1,2,3,4].map(e=>(0,h.jsxs)("option",{value:e,children:["Court ",e]},e))})]}),(0,h.jsxs)("div",{className:"flex-1",children:[(0,h.jsx)("label",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Start Time"}),(0,h.jsx)("select",{value:g,onChange:e=>N(e.target.value),className:"w-full text-sm border-slate-300 rounded focus:border-slate-900 focus:ring-0",children:k.map(e=>(0,h.jsxs)("option",{value:e,children:[e,":00"]},e))})]}),(0,h.jsx)("button",{onClick:()=>{const e=new Date;e.setHours(parseInt(g),0,0,0);const t=new Date(e);t.setHours(e.getHours()+1),n(r.id,{courtId:parseInt(j),startTime:e.toISOString(),endTime:t.toISOString()}),v(!1)},className:"px-4 py-2 bg-slate-900 text-white text-sm font-medium rounded shadow-sm hover:bg-slate-800",children:"Add"})]}),(0,h.jsx)("div",{className:"space-y-3",children:C.map(e=>{const t=P[e],l=S[e];return l.sort((e,t)=>new Date(e.startTime)-new Date(t.startTime)),(0,h.jsxs)("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:[(0,h.jsxs)("button",{onClick:()=>(e=>{A(t=>(0,a.A)((0,a.A)({},t),{},{[e]:!t[e]}))})(e),className:"w-full flex items-center justify-between px-4 py-2.5 bg-slate-50 hover:bg-slate-100 transition-colors",children:[(0,h.jsxs)("div",{className:"flex items-center gap-2",children:[(0,h.jsxs)("span",{className:"font-semibold text-sm text-slate-700",children:["Court ",e]}),(0,h.jsxs)("span",{className:"px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 text-[10px] font-bold",children:[l.length," Slots"]})]}),t?(0,h.jsx)(i,{className:"h-4 w-4 text-slate-400"}):(0,h.jsx)(c,{className:"h-4 w-4 text-slate-400"})]}),!t&&(0,h.jsx)("table",{className:"min-w-full divide-y divide-slate-200",children:(0,h.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:l.map(e=>{const t=new Date(e.startTime),a=new Date(e.endTime),l="".concat(t.getHours(),":00 - ").concat(a.getHours(),":00");return(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{className:"px-4 py-3 text-sm text-slate-500 whitespace-nowrap w-1/3",children:l}),(0,h.jsx)("td",{className:"px-4 py-3 text-sm text-slate-500 w-1/3",children:e.price}),(0,h.jsx)("td",{className:"px-4 py-3 text-sm",children:(0,h.jsx)("button",{onClick:()=>o(r.id,e.slotId,!e.isPaid),className:p("relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none",e.isPaid?"bg-emerald-500":"bg-slate-200"),children:(0,h.jsx)("span",{className:p("pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",e.isPaid?"translate-x-5":"translate-x-0")})})}),(0,h.jsx)("td",{className:"px-4 py-3 text-right text-sm font-medium",children:(0,h.jsx)("button",{onClick:()=>s(e),className:"text-slate-400 hover:text-rose-600 transition-colors",children:(0,h.jsx)(m,{className:"h-4 w-4"})})})]},e.slotId)})})})]},e)})})]})},f=e=>{let{logs:t}=e;return(0,h.jsx)("div",{className:"space-y-4",children:(0,h.jsx)("div",{className:"relative border-l-2 border-slate-200 ml-3 space-y-6 py-2",children:t.slice().reverse().map((e,t)=>(0,h.jsxs)("div",{className:"relative pl-6",children:[(0,h.jsx)("div",{className:"absolute -left-[9px] top-0 bg-white border-2 border-slate-300 rounded-full h-4 w-4 flex items-center justify-center",children:(0,h.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"})}),(0,h.jsxs)("div",{children:[(0,h.jsx)("p",{className:"text-xs font-semibold text-slate-700 uppercase tracking-wide",children:e.action.replace(/_/g," ")}),(0,h.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:e.details}),(0,h.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:new Date(e.timestamp).toLocaleString()})]})]},t))})})}}}]);