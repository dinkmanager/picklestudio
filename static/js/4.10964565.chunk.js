"use strict";(self.webpackChunkpickleball_courts=self.webpackChunkpickleball_courts||[]).push([[4],{9623:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var r=n(9740),o=n(9950);var a=n(2004),s=n(9800),i=n(4414);function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,s.QP)((0,a.$)(t))}function d(e){let{courts:t=[],openHour:n=7,closeHour:a=22,bookings:s={},slots:d=[],currentDate:u=new Date,onTimeSelect:c,onBookingClick:m,isEditMode:b=!1,modifiedSlots:p={},onSlotMove:x}=e;const h=u.toLocaleDateString("en-CA"),g=(0,o.useMemo)(()=>{const e=d.filter(e=>e.date===h&&"ACTIVE"===e.status);return b?e.map(e=>p[e.slotId]?(0,r.A)((0,r.A)({},e),p[e.slotId]):e):e},[d,h,b,p]),f=(0,o.useMemo)(()=>{const e=[];for(let t=n;t<a;t++)e.push({hour:t,minute:0,label:"".concat(t,":00")});return e},[n,a]),{handleMouseDown:M,handleMouseEnter:I,handleMouseUp:v,selectionBox:w}=function(e){let{courts:t=[],openingHour:n=7,closingHour:r=21,onSelectionComplete:a}=e;const[s,i]=(0,o.useState)(!1),[l,d]=(0,o.useState)(null),[u,c]=(0,o.useState)(null);return(0,o.useRef)(null),{isDragging:s,handleMouseDown:(e,t)=>{i(!0),d({courtId:e,timeInMinutes:t}),c({courtId:e,timeInMinutes:t})},handleMouseEnter:(e,t)=>{s&&c({courtId:e,timeInMinutes:t})},handleMouseUp:()=>{if(s&&(i(!1),l&&u)){const e=Math.min(l.timeInMinutes,u.timeInMinutes),n=Math.max(l.timeInMinutes,u.timeInMinutes)+30,r=t.findIndex(e=>e.id===l.courtId),o=t.findIndex(e=>e.id===u.courtId),s=Math.min(r,o),i=Math.max(r,o),d=t.slice(s,i+1).map(e=>e.id);a&&a({startMinutes:e,endMinutes:n,courtIds:d})}},cancelSelection:()=>{i(!1),d(null),c(null)},selectionBox:l&&u?{start:{courtId:l.courtId,time:Math.min(l.timeInMinutes,u.timeInMinutes)},end:{courtId:u.courtId,time:Math.max(l.timeInMinutes,u.timeInMinutes)}}:null}}({courts:t,onSelectionComplete:c}),D=e=>{b&&(e.preventDefault(),e.dataTransfer.dropEffect="move")};return(0,i.jsxs)("div",{className:"select-none overflow-auto pb-20 relative bg-white h-full",onMouseUp:v,onMouseLeave:v,children:[(0,i.jsxs)("div",{className:"min-w-[1000px]",children:[(0,i.jsx)("div",{className:"flex border-b border-slate-100 sticky top-0 bg-white z-20 shadow-sm ml-24",children:f.map((e,t)=>(0,i.jsx)("div",{className:"flex-1 min-w-[60px] h-10 border-r border-slate-50 relative flex items-end pb-1 justify-center",children:e.label&&(0,i.jsx)("span",{className:"text-xs font-medium text-slate-400 font-mono transform -translate-x-1/2 absolute left-0 bottom-1 bg-white px-1",children:e.label})},t))}),(0,i.jsx)("div",{className:"relative",children:t.map(e=>(0,i.jsxs)("div",{className:"flex h-24 border-b border-slate-100 group",children:[(0,i.jsx)("div",{className:"w-24 flex-shrink-0 sticky left-0 bg-white z-10 border-r border-slate-100 flex items-center justify-center font-bold text-slate-700 shadow-[4px_0_24px_-12px_rgba(0,0,0,0.1)]",children:e.name}),f.map((n,r)=>{const o=60*n.hour+n.minute,a=g.find(t=>{if(String(t.courtId)!==String(e.id))return!1;const n=s[t.bookingId];return(!n||"CANCELLED"!==n.status)&&(o>=t.startTime&&o<t.endTime)}),d=((e,n)=>{if(!w)return!1;const r=w.start,o=w.end,a=t.findIndex(t=>t.id===e),s=t.findIndex(e=>e.id===r.courtId),i=t.findIndex(e=>e.id===o.courtId),l=Math.min(s,i),d=Math.max(s,i),u=Math.min(r.time,o.time),c=Math.max(r.time,o.time);return a>=l&&a<=d&&n>=u&&n<=c})(e.id,o),u=a&&a.startTime===o;let c=null,h="",f="",v=a&&p[a.slotId];if(a&&(c=s[a.bookingId],c)){if("OPEN_PLAY_BLOCK"===c.type)h="bg-slate-100 text-slate-400 opacity-60 bg-[url('https://www.transparenttextures.com/patterns/diagonal-stripes.png')]";else{var j;f=(null===(j=c.renter)||void 0===j?void 0:j.name)||"Occupied";const e=c.paymentSummary||{},t=(e.amountPaid||0)>=(e.totalAmount||0)&&e.totalAmount>0,n=!t&&(e.amountPaid||0)>0;h=t?"bg-emerald-100 text-emerald-800 border-emerald-200":n?"bg-orange-50 text-orange-800 border-orange-200 border-l-4 border-l-orange-400":"bg-amber-50 text-amber-800 border-amber-200 striped-bg"}v&&(h="bg-blue-100 text-blue-900 border-blue-300 ring-2 ring-blue-500/20 z-10")}return(0,i.jsx)("div",{className:l("flex-1 min-w-[60px] border-r border-slate-50 relative transition-colors duration-75",!a&&d&&"bg-emerald-500/20",!a&&!d&&!b&&"hover:bg-slate-50",0===n.minute&&"border-r-slate-100",b&&!a&&"hover:bg-blue-50/50"),onMouseDown:()=>!b&&!a&&M(e.id,o),onMouseEnter:()=>!b&&!a&&I(e.id,o),onDragOver:D,onDrop:t=>((e,t,n)=>{if(!b)return;e.preventDefault();const r=e.dataTransfer.getData("text/plain");x&&x(r,n,t)})(t,e.id,o),children:a&&c&&(0,i.jsx)("div",{draggable:b,onDragStart:e=>((e,t)=>{b&&(e.dataTransfer.setData("text/plain",t),e.dataTransfer.effectAllowed="move")})(e,a.slotId),onClick:e=>{e.stopPropagation(),b||m&&m(c.id)},className:l("absolute inset-0 m-0.5 rounded flex items-center justify-center text-[10px] font-bold truncate px-1 shadow-sm transition-all border",h,a&&"OPEN_PLAY_BLOCK"===c.type&&"cursor-default",!u&&"border-l-0 rounded-l-none opacity-80",!b&&"cursor-pointer hover:brightness-95",b&&"cursor-move hover:scale-[1.02] hover:shadow-md hover:ring-2 ring-emerald-400/50 z-20"),style:{zIndex:v?30:1},children:u&&(0,i.jsxs)(i.Fragment,{children:["OPEN_PLAY_BLOCK"===c.type?"BLOCKED":f,v&&(0,i.jsx)("span",{className:"ml-1 text-[8px] bg-blue-600 text-white rounded px-1",children:"MOD"})]})})},r)})]},e.id))})]}),(0,i.jsx)("style",{children:"\n                .striped-bg {\n                    background-image: repeating-linear-gradient(\n                        45deg,\n                        transparent,\n                        transparent 5px,\n                        rgba(255, 255, 255, 0.4) 5px,\n                        rgba(255, 255, 255, 0.4) 10px\n                    );\n                }\n            "})]})}}}]);