"use strict";(self.webpackChunkpickleball_courts=self.webpackChunkpickleball_courts||[]).push([[4],{9623:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var r=n(9740),o=n(9950);var i=n(2004),a=n(9800),l=n(4414);function s(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.QP)((0,i.$)(t))}function d(e){let{courts:t=[],openHour:n=7,closeHour:i=22,bookings:a={},slots:d=[],currentDate:u=new Date,onTimeSelect:c,onBookingClick:m,isEditMode:b=!1,modifiedSlots:h={},onSlotMove:g}=e;const x=u.toLocaleDateString("en-CA"),f=(0,o.useMemo)(()=>{const e=d.filter(e=>e.date===x&&"ACTIVE"===e.status);return b?e.map(e=>h[e.slotId]?(0,r.A)((0,r.A)({},e),h[e.slotId]):e):e},[d,x,b,h]),p=(0,o.useMemo)(()=>{const e=[];for(let t=n;t<i;t++)e.push({hour:t,minute:0,label:"".concat(t,":00")});return e},[n,i]),{handleMouseDown:v,handleMouseEnter:I,handleMouseUp:M,handleTouchStart:w,handleTouchMove:S,handleTouchEnd:T,selectionBox:k}=function(e){let{courts:t=[],openingHour:n=7,closingHour:r=21,onSelectionComplete:i}=e;const[a,l]=(0,o.useState)(!1),[s,d]=(0,o.useState)(null),[u,c]=(0,o.useState)(null),m=((0,o.useRef)(null),()=>{if(a&&(l(!1),s&&u)){const e=Math.min(s.timeInMinutes,u.timeInMinutes),n=Math.max(s.timeInMinutes,u.timeInMinutes)+30,r=t.findIndex(e=>String(e.id)===String(s.courtId)),o=t.findIndex(e=>String(e.id)===String(u.courtId)),a=Math.min(r,o),l=Math.max(r,o),d=t.slice(a,l+1).map(e=>e.id);i&&i({startMinutes:e,endMinutes:n,courtIds:d})}}),b=(0,o.useRef)(null);return{isDragging:a,handleMouseDown:(e,t)=>{l(!0),d({courtId:e,timeInMinutes:t}),c({courtId:e,timeInMinutes:t})},handleMouseEnter:(e,t)=>{a&&c({courtId:e,timeInMinutes:t})},handleMouseUp:m,handleTouchStart:(e,t)=>{b.current=setTimeout(()=>{var n;l(!0),d({courtId:e,timeInMinutes:t}),c({courtId:e,timeInMinutes:t}),null!==(n=window.navigator)&&void 0!==n&&n.vibrate&&window.navigator.vibrate(50)},500)},handleTouchMove:e=>{if(b.current&&!a)return clearTimeout(b.current),void(b.current=null);if(!a)return;e.cancelable&&e.preventDefault();const t=e.touches[0],n=document.elementFromPoint(t.clientX,t.clientY);if(n){const e=n.getAttribute("data-court-id"),t=n.getAttribute("data-time");e&&t&&c({courtId:e,timeInMinutes:parseInt(t)})}},handleTouchEnd:()=>{b.current&&(clearTimeout(b.current),b.current=null),a&&m()},cancelSelection:()=>{l(!1),d(null),c(null),b.current&&clearTimeout(b.current)},selectionBox:s&&u?{start:{courtId:s.courtId,time:Math.min(s.timeInMinutes,u.timeInMinutes)},end:{courtId:u.courtId,time:Math.max(s.timeInMinutes,u.timeInMinutes)}}:null}}({courts:t,onSelectionComplete:c}),y=e=>{b&&(e.preventDefault(),e.dataTransfer.dropEffect="move")};return(0,l.jsxs)("div",{className:"select-none overflow-auto pb-20 relative bg-white h-full",onMouseUp:M,onMouseLeave:M,children:[(0,l.jsxs)("div",{className:"min-w-[1000px]",children:[(0,l.jsx)("div",{className:"flex border-b border-slate-100 sticky top-0 bg-white z-20 shadow-sm ml-24",children:p.map((e,t)=>(0,l.jsx)("div",{className:"flex-1 min-w-[60px] h-10 border-r border-slate-50 relative flex items-end pb-1 justify-center",children:e.label&&(0,l.jsx)("span",{className:"text-xs font-medium text-slate-400 font-mono transform -translate-x-1/2 absolute left-0 bottom-1 bg-white px-1",children:e.label})},t))}),(0,l.jsx)("div",{className:"relative",children:t.map(e=>(0,l.jsxs)("div",{className:"flex h-24 border-b border-slate-100 group",children:[(0,l.jsx)("div",{className:"w-24 flex-shrink-0 sticky left-0 bg-white z-10 border-r border-slate-100 flex items-center justify-center font-bold text-slate-700 shadow-[4px_0_24px_-12px_rgba(0,0,0,0.1)]",children:e.name}),p.map((n,r)=>{const o=60*n.hour+n.minute,i=f.find(t=>{if(String(t.courtId)!==String(e.id))return!1;const n=a[t.bookingId];return(!n||"CANCELLED"!==n.status)&&(o>=t.startTime&&o<t.endTime)}),u=((e,n)=>{if(!k)return!1;const r=k.start,o=k.end,i=t.findIndex(t=>String(t.id)===String(e)),a=t.findIndex(e=>String(e.id)===String(r.courtId)),l=t.findIndex(e=>String(e.id)===String(o.courtId)),s=Math.min(a,l),d=Math.max(a,l),u=Math.min(r.time,o.time),c=Math.max(r.time,o.time);return i>=s&&i<=d&&n>=u&&n<=c})(e.id,o),c=i&&i.startTime===o;let x=null,p="",M="",D=i&&h[i.slotId];if(i&&(x=a[i.bookingId],x)){if("OPEN_PLAY_BLOCK"===x.type)p="bg-blue-50 text-blue-600 border-blue-200 border-l-4 border-l-blue-400";else{var j;M=(null===(j=x.renter)||void 0===j?void 0:j.name)||"Occupied";const e=d.filter(e=>e.bookingId===x.id).reduce((e,t)=>e+(t.price||0),0),t=x.paymentSummary||{},n=(t.amountPaid||0)>=(e||0)&&e>0,r=!n&&(t.amountPaid||0)>0;p=n?"bg-emerald-100 text-emerald-800 border-emerald-200":r?"bg-yellow-100 text-yellow-800 border-yellow-200 border-l-4 border-l-yellow-400":"bg-red-50 text-red-900 border-red-200 border-l-4 border-l-red-500"}D&&(p="bg-blue-100 text-blue-900 border-blue-300 ring-2 ring-blue-500/20 z-10")}return(0,l.jsx)("div",{className:s("flex-1 min-w-[60px] border-r border-slate-50 relative transition-colors duration-75",!i&&u&&"bg-emerald-500/20",!i&&!u&&!b&&"hover:bg-slate-50",0===n.minute&&"border-r-slate-100",b&&!i&&"hover:bg-blue-50/50"),onTouchStart:()=>!b&&!i&&w(e.id,o),onTouchMove:S,onTouchEnd:T,"data-court-id":e.id,"data-time":o,onMouseDown:()=>!b&&!i&&v(e.id,o),onMouseEnter:()=>!b&&!i&&I(e.id,o),onDragOver:y,onDrop:t=>((e,t,n)=>{if(!b)return;e.preventDefault();const r=e.dataTransfer.getData("text/plain");g&&g(r,n,t)})(t,e.id,o),children:i&&x&&(0,l.jsx)("div",{draggable:b,onDragStart:e=>((e,t)=>{b&&(e.dataTransfer.setData("text/plain",t),e.dataTransfer.effectAllowed="move")})(e,i.slotId),onClick:e=>{e.stopPropagation(),b||m&&m(x.id)},className:s("absolute inset-0 m-0.5 rounded flex items-center justify-center text-[10px] font-bold truncate px-1 shadow-sm transition-all border",p,!b&&"cursor-pointer hover:brightness-95",b&&"cursor-move hover:scale-[1.02] hover:shadow-md hover:ring-2 ring-emerald-400/50 z-20"),style:{zIndex:D?30:1},children:c&&(0,l.jsxs)(l.Fragment,{children:["OPEN_PLAY_BLOCK"===x.type?x.title||"Open Play":M,D&&(0,l.jsx)("span",{className:"ml-1 text-[8px] bg-blue-600 text-white rounded px-1",children:"MOD"})]})})},r)})]},e.id))})]}),(0,l.jsx)("style",{children:"\n                .striped-bg {\n                    background-image: repeating-linear-gradient(\n                        45deg,\n                        transparent,\n                        transparent 5px,\n                        rgba(255, 255, 255, 0.4) 5px,\n                        rgba(255, 255, 255, 0.4) 10px\n                    );\n                }\n            "})]})}}}]);