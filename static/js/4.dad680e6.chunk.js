"use strict";(self.webpackChunkpickleball_courts=self.webpackChunkpickleball_courts||[]).push([[4],{9623:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var r=n(9740),o=n(9950);var a=n(2004),i=n(9800),s=n(4414);function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,i.QP)((0,a.$)(t))}function d(e){let{courts:t=[],openHour:n=7,closeHour:a=22,bookings:i={},slots:d=[],currentDate:u=new Date,onTimeSelect:c,onBookingClick:m,isEditMode:b=!1,modifiedSlots:h={},onSlotMove:g}=e;const p=u.toLocaleDateString("en-CA"),x=(0,o.useMemo)(()=>{const e=d.filter(e=>e.date===p&&"ACTIVE"===e.status);return b?e.map(e=>h[e.slotId]?(0,r.A)((0,r.A)({},e),h[e.slotId]):e):e},[d,p,b,h]),f=(0,o.useMemo)(()=>{const e=[];for(let t=n;t<a;t++)e.push({hour:t,minute:0,label:"".concat(t,":00")});return e},[n,a]),{handleMouseDown:v,handleMouseEnter:I,handleMouseUp:M,handleTouchStart:w,handleTouchMove:S,handleTouchEnd:T,selectionBox:D}=function(e){let{courts:t=[],openingHour:n=7,closingHour:r=21,onSelectionComplete:a}=e;const[i,s]=(0,o.useState)(!1),[l,d]=(0,o.useState)(null),[u,c]=(0,o.useState)(null),m=((0,o.useRef)(null),()=>{if(i&&(s(!1),l&&u)){const e=Math.min(l.timeInMinutes,u.timeInMinutes),n=Math.max(l.timeInMinutes,u.timeInMinutes)+30,r=t.findIndex(e=>e.id===l.courtId),o=t.findIndex(e=>e.id===u.courtId),i=Math.min(r,o),s=Math.max(r,o),d=t.slice(i,s+1).map(e=>e.id);a&&a({startMinutes:e,endMinutes:n,courtIds:d})}}),b=(0,o.useRef)(null);return{isDragging:i,handleMouseDown:(e,t)=>{s(!0),d({courtId:e,timeInMinutes:t}),c({courtId:e,timeInMinutes:t})},handleMouseEnter:(e,t)=>{i&&c({courtId:e,timeInMinutes:t})},handleMouseUp:m,handleTouchStart:(e,t)=>{b.current=setTimeout(()=>{var n;s(!0),d({courtId:e,timeInMinutes:t}),c({courtId:e,timeInMinutes:t}),null!==(n=window.navigator)&&void 0!==n&&n.vibrate&&window.navigator.vibrate(50)},500)},handleTouchMove:e=>{if(b.current&&!i)return clearTimeout(b.current),void(b.current=null);if(!i)return;e.cancelable&&e.preventDefault();const t=e.touches[0],n=document.elementFromPoint(t.clientX,t.clientY);if(n){const e=n.getAttribute("data-court-id"),t=n.getAttribute("data-time");e&&t&&c({courtId:e,timeInMinutes:parseInt(t)})}},handleTouchEnd:()=>{b.current&&(clearTimeout(b.current),b.current=null),i&&m()},cancelSelection:()=>{s(!1),d(null),c(null),b.current&&clearTimeout(b.current)},selectionBox:l&&u?{start:{courtId:l.courtId,time:Math.min(l.timeInMinutes,u.timeInMinutes)},end:{courtId:u.courtId,time:Math.max(l.timeInMinutes,u.timeInMinutes)}}:null}}({courts:t,onSelectionComplete:c}),j=e=>{b&&(e.preventDefault(),e.dataTransfer.dropEffect="move")};return(0,s.jsxs)("div",{className:"select-none overflow-auto pb-20 relative bg-white h-full",onMouseUp:M,onMouseLeave:M,children:[(0,s.jsxs)("div",{className:"min-w-[1000px]",children:[(0,s.jsx)("div",{className:"flex border-b border-slate-100 sticky top-0 bg-white z-20 shadow-sm ml-24",children:f.map((e,t)=>(0,s.jsx)("div",{className:"flex-1 min-w-[60px] h-10 border-r border-slate-50 relative flex items-end pb-1 justify-center",children:e.label&&(0,s.jsx)("span",{className:"text-xs font-medium text-slate-400 font-mono transform -translate-x-1/2 absolute left-0 bottom-1 bg-white px-1",children:e.label})},t))}),(0,s.jsx)("div",{className:"relative",children:t.map(e=>(0,s.jsxs)("div",{className:"flex h-24 border-b border-slate-100 group",children:[(0,s.jsx)("div",{className:"w-24 flex-shrink-0 sticky left-0 bg-white z-10 border-r border-slate-100 flex items-center justify-center font-bold text-slate-700 shadow-[4px_0_24px_-12px_rgba(0,0,0,0.1)]",children:e.name}),f.map((n,r)=>{const o=60*n.hour+n.minute,a=x.find(t=>{if(String(t.courtId)!==String(e.id))return!1;const n=i[t.bookingId];return(!n||"CANCELLED"!==n.status)&&(o>=t.startTime&&o<t.endTime)}),d=((e,n)=>{if(!D)return!1;const r=D.start,o=D.end,a=t.findIndex(t=>String(t.id)===String(e)),i=t.findIndex(e=>String(e.id)===String(r.courtId)),s=t.findIndex(e=>String(e.id)===String(o.courtId)),l=Math.min(i,s),d=Math.max(i,s),u=Math.min(r.time,o.time),c=Math.max(r.time,o.time);return a>=l&&a<=d&&n>=u&&n<=c})(e.id,o),u=a&&a.startTime===o;let c=null,p="",f="",M=a&&h[a.slotId];if(a&&(c=i[a.bookingId],c)){if("OPEN_PLAY_BLOCK"===c.type)p="bg-slate-100 text-slate-400 opacity-60 bg-[url('https://www.transparenttextures.com/patterns/diagonal-stripes.png')]";else{var k;f=(null===(k=c.renter)||void 0===k?void 0:k.name)||"Occupied";const e=c.paymentSummary||{},t=(e.amountPaid||0)>=(e.totalAmount||0)&&e.totalAmount>0,n=!t&&(e.amountPaid||0)>0;p=t?"bg-emerald-100 text-emerald-800 border-emerald-200":n?"bg-orange-50 text-orange-800 border-orange-200 border-l-4 border-l-orange-400":"bg-amber-50 text-amber-800 border-amber-200 striped-bg"}M&&(p="bg-blue-100 text-blue-900 border-blue-300 ring-2 ring-blue-500/20 z-10")}return(0,s.jsx)("div",{className:l("flex-1 min-w-[60px] border-r border-slate-50 relative transition-colors duration-75",!a&&d&&"bg-emerald-500/20",!a&&!d&&!b&&"hover:bg-slate-50",0===n.minute&&"border-r-slate-100",b&&!a&&"hover:bg-blue-50/50"),onTouchStart:()=>!b&&!a&&w(e.id,o),onTouchMove:S,onTouchEnd:T,"data-court-id":e.id,"data-time":o,onMouseDown:()=>!b&&!a&&v(e.id,o),onMouseEnter:()=>!b&&!a&&I(e.id,o),onDragOver:j,onDrop:t=>((e,t,n)=>{if(!b)return;e.preventDefault();const r=e.dataTransfer.getData("text/plain");g&&g(r,n,t)})(t,e.id,o),children:a&&c&&(0,s.jsx)("div",{draggable:b,onDragStart:e=>((e,t)=>{b&&(e.dataTransfer.setData("text/plain",t),e.dataTransfer.effectAllowed="move")})(e,a.slotId),onClick:e=>{e.stopPropagation(),b||m&&m(c.id)},className:l("absolute inset-0 m-0.5 rounded flex items-center justify-center text-[10px] font-bold truncate px-1 shadow-sm transition-all border",p,a&&"OPEN_PLAY_BLOCK"===c.type&&"cursor-default",!u&&"border-l-0 rounded-l-none opacity-80",!b&&"cursor-pointer hover:brightness-95",b&&"cursor-move hover:scale-[1.02] hover:shadow-md hover:ring-2 ring-emerald-400/50 z-20"),style:{zIndex:M?30:1},children:u&&(0,s.jsxs)(s.Fragment,{children:["OPEN_PLAY_BLOCK"===c.type?"BLOCKED":f,M&&(0,s.jsx)("span",{className:"ml-1 text-[8px] bg-blue-600 text-white rounded px-1",children:"MOD"})]})})},r)})]},e.id))})]}),(0,s.jsx)("style",{children:"\n                .striped-bg {\n                    background-image: repeating-linear-gradient(\n                        45deg,\n                        transparent,\n                        transparent 5px,\n                        rgba(255, 255, 255, 0.4) 5px,\n                        rgba(255, 255, 255, 0.4) 10px\n                    );\n                }\n            "})]})}}}]);