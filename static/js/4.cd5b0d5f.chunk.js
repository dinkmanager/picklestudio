"use strict";(self.webpackChunkpickleball_courts=self.webpackChunkpickleball_courts||[]).push([[4],{9623:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var r=n(9950);var o=n(2004),i=n(9800),s=n(4414);function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,i.QP)((0,o.$)(t))}function l(e){let{courts:t=[],openHour:n=7,closeHour:o=22,bookings:i={},slots:l=[],currentDate:d=new Date,onTimeSelect:u,onBookingClick:c}=e;const m=d.toLocaleDateString("en-CA"),b=(0,r.useMemo)(()=>l.filter(e=>e.date===m&&"ACTIVE"===e.status),[l,m]),x=(0,r.useMemo)(()=>{const e=[];for(let t=n;t<o;t++)e.push({hour:t,minute:0,label:"".concat(t,":00")});return e},[n,o]),{handleMouseDown:p,handleMouseEnter:h,handleMouseUp:g,selectionBox:f}=function(e){let{courts:t=[],openingHour:n=7,closingHour:o=21,onSelectionComplete:i}=e;const[s,a]=(0,r.useState)(!1),[l,d]=(0,r.useState)(null),[u,c]=(0,r.useState)(null);return(0,r.useRef)(null),{isDragging:s,handleMouseDown:(e,t)=>{a(!0),d({courtId:e,timeInMinutes:t}),c({courtId:e,timeInMinutes:t})},handleMouseEnter:(e,t)=>{s&&c({courtId:e,timeInMinutes:t})},handleMouseUp:()=>{if(s&&(a(!1),l&&u)){const e=Math.min(l.timeInMinutes,u.timeInMinutes),n=Math.max(l.timeInMinutes,u.timeInMinutes)+30,r=t.findIndex(e=>e.id===l.courtId),o=t.findIndex(e=>e.id===u.courtId),s=Math.min(r,o),a=Math.max(r,o),d=t.slice(s,a+1).map(e=>e.id);i&&i({startMinutes:e,endMinutes:n,courtIds:d})}},cancelSelection:()=>{a(!1),d(null),c(null)},selectionBox:l&&u?{start:{courtId:l.courtId,time:Math.min(l.timeInMinutes,u.timeInMinutes)},end:{courtId:u.courtId,time:Math.max(l.timeInMinutes,u.timeInMinutes)}}:null}}({courts:t,onSelectionComplete:u});return(0,s.jsxs)("div",{className:"select-none overflow-auto pb-20 relative bg-white h-full",onMouseUp:g,onMouseLeave:g,children:[(0,s.jsxs)("div",{className:"min-w-[1000px]",children:[(0,s.jsx)("div",{className:"flex border-b border-slate-100 sticky top-0 bg-white z-20 shadow-sm ml-24",children:x.map((e,t)=>(0,s.jsx)("div",{className:"flex-1 min-w-[60px] h-10 border-r border-slate-50 relative flex items-end pb-1 justify-center",children:e.label&&(0,s.jsx)("span",{className:"text-xs font-medium text-slate-400 font-mono transform -translate-x-1/2 absolute left-0 bottom-1 bg-white px-1",children:e.label})},t))}),(0,s.jsx)("div",{className:"relative",children:t.map(e=>(0,s.jsxs)("div",{className:"flex h-24 border-b border-slate-100 group",children:[(0,s.jsx)("div",{className:"w-24 flex-shrink-0 sticky left-0 bg-white z-10 border-r border-slate-100 flex items-center justify-center font-bold text-slate-700 shadow-[4px_0_24px_-12px_rgba(0,0,0,0.1)]",children:e.name}),x.map((n,r)=>{const o=60*n.hour+n.minute,l=b.find(t=>{if(String(t.courtId)!==String(e.id))return!1;const n=i[t.bookingId];return(!n||"CANCELLED"!==n.status)&&(o>=t.startTime&&o<t.endTime)}),d=((e,n)=>{if(!f)return!1;const r=f.start,o=f.end,i=t.findIndex(t=>t.id===e),s=t.findIndex(e=>e.id===r.courtId),a=t.findIndex(e=>e.id===o.courtId),l=Math.min(s,a),d=Math.max(s,a),u=Math.min(r.time,o.time),c=Math.max(r.time,o.time);return i>=l&&i<=d&&n>=u&&n<=c})(e.id,o),u=l&&l.startTime===o;let m=null,x="",g="";if(l&&(m=i[l.bookingId],m))if("OPEN_PLAY_BLOCK"===m.type)x="bg-slate-100 text-slate-400 opacity-60 bg-[url('https://www.transparenttextures.com/patterns/diagonal-stripes.png')]";else{var M;g=(null===(M=m.renter)||void 0===M?void 0:M.name)||"Occupied";const e=m.paymentSummary||{},t=(e.amountPaid||0)>=(e.totalAmount||0)&&e.totalAmount>0,n=!t&&(e.amountPaid||0)>0;x=t?"bg-emerald-100 text-emerald-800 border-emerald-200":n?"bg-orange-50 text-orange-800 border-orange-200 border-l-4 border-l-orange-400":"bg-amber-50 text-amber-800 border-amber-200 striped-bg"}return(0,s.jsx)("div",{className:a("flex-1 min-w-[60px] border-r border-slate-50 relative transition-colors duration-75",!l&&d&&"bg-emerald-500/20",!l&&!d&&"hover:bg-slate-50",0===n.minute&&"border-r-slate-100"),onMouseDown:()=>!l&&p(e.id,o),onMouseEnter:()=>!l&&h(e.id,o),children:l&&m&&(0,s.jsx)("div",{onClick:e=>{e.stopPropagation(),c&&c(m.id)},className:a("absolute inset-0 m-0.5 rounded flex items-center justify-center text-[10px] font-bold truncate px-1 shadow-sm cursor-pointer hover:brightness-95 transition-all border",x,l&&"OPEN_PLAY_BLOCK"===m.type&&"cursor-default",!u&&"border-l-0 rounded-l-none opacity-80"),style:{zIndex:1},children:u&&("OPEN_PLAY_BLOCK"===m.type?"BLOCKED":g)})},r)})]},e.id))})]}),(0,s.jsx)("style",{children:"\n                .striped-bg {\n                    background-image: repeating-linear-gradient(\n                        45deg,\n                        transparent,\n                        transparent 5px,\n                        rgba(255, 255, 255, 0.4) 5px,\n                        rgba(255, 255, 255, 0.4) 10px\n                    );\n                }\n            "})]})}}}]);